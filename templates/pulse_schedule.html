<head>
    <style>
        @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&display=swap");
    </style>
    <link
        href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.0.2/tailwind.min.css"
        rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/common.js"></script>
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script>
    let idle_secconds = 0;
    let fact_secconds = 0;
    function incrementSeconds() {
        idle_secconds++;
        // fact_secconds++
        // console.log('idle for:',idle_secconds, 'seccond')
        // console.log('fact secconds: ',fact_secconds)
        if (idle_secconds >= 120) {
            // window.location.href = "/";
        }
        // if (fact_secconds >= 10) {
        //     fact_secconds = 0
        //     getFunFact()
        // }
    }

    window.addEventListener("touchstart", () => {
        idle_secconds = 0;
        console.log("reset");
    });

    const myTeam = '1000' // TESTING! change to 1540 before using at events
    const eventKey = '2024cc'

    async function getNexusData() {
        const response = await fetch('/getnexusdata')
        let data = await response.json()
        console.log('Nexus data')
        console.log(data)
        let upmatches = data[4]
        let html = ''
        if (upmatches.length == 0) {
            html = myTeam+' does not have any upcoming matches'
            nextup.innerHTML = myTeam+' does not have any upcoming matches'
        }
        else {
            for (let i = 0; i<upmatches.length; i++) {
                // console.log(upmatches[i])
                if (data[4] != ''){html += upmatches[i]['label']+": "+upmatches[i]['status']} else {upmatch.innerHTML = 'Team '+myTeam+' does not have any upcomming matches'}
                html += '<br>'
            }
        }
        upmatch.innerHTML = html
        nextMatch = upmatches[0]
        let nextColor = 'ERROR'
        for (let i = 0; i<nextMatch['blueTeams'].length; i++) {
            if (nextMatch['blueTeams'][i] == myTeam) {nextColor = 'blue'}
            else if (nextMatch['redTeams'][i] == myTeam) {nextColor = 'red'}
        }
        if (nextColor == 'blue') colorhtml = '<div id="bluebumper">You will be wearing the '+nextColor+' bumbers</div>'
        else if (nextColor = 'red') colorhtml = '<div id="redbumper">You will be wearing the '+nextColor+' bumbers</div>'

        nextup.innerHTML = 'Your next match is '+nextMatch['label']+' and is '+nextMatch['status']+colorhtml+'Blue Alliance: '+nextMatch['blueTeams']+'<br>Red Teams: '+nextMatch['redTeams']}
    
    async function getPrediction() {
        const response = await fetch('/getprediction')
        let data = await response.json()
        matchPrediction = data['match_predictions']
        console.log('predection')
        // console.log(matchPrediction)
        console.log(nextMatch)
    }
        //  async function getStatBotData() {
    //  async function getStatBotData() {
    //     console.log('Stat bot data')
    //     const response = await fetch('/getstatbotdata')
    //     let data = await response.json()
    //     stats.innerHTML = 'Total EPA: '+data[0]+' | Wins: '+data[1]+' | Losses: '+data[2]

    //  }
    getNexusData()
    getPrediction()
    // getStatBotData()
    // getFunFact()
    setInterval(everySeccond, 1000);
    function everySeccond() {
        incrementSeconds();
        getTime();
    }
    setInterval(every30s, 30000)
    function every30s() {
        getNexusData()
        getPrediction()
        // getStatBotData()
    }
</script>
<body
    style="background-color: #1c1c1c"
    onclick="openFullscreen()"
    onload="getTime()"
>
    <div id="header">
        <h1 id="title" class="row-start-1 col-start-1">Hensight</h1>
        <h1 id="time" class="row-start-1 col-start-2"></h1>
    </div>
    <div id="thediv">
        <div class="inner-div grid col-start-1 col-end-4 row-start-1" id="upmatch">Loading...</div>
        <div class="inner-div grid col-start-1 col-end-4 row-start-2" id="nextup">Loading...</div>
        <div class="inner-div btn grid col-start-1  row-start-3" onclick="window.location.href = '/pulse_rip_off'" style="font-size: 2.5rem;">Main</div>
        <div class="inner-div btn border grid col-start-2  row-start-3" onclick="window.location.href='/menu'" style="font-size: 2.5rem;">Main menu</div>
        <div class="inner-div btn grid col-start-3  row-start-3" onclick="window.location.href = '/pulse_ranking'" style="font-size: 2.5rem;">Ranking</div>
    </div>
</body>
<style>
    .border {
        border: 0.5rem solid; /* Adjust border width as needed */
        border-image: linear-gradient(to bottom right, #F6B14B, #FF4848) 30;
    }
    #bluebumper {
        color: white;
        text-shadow: -5px 5px 0 blue,
                      5px 5px 0 blue,
                      5px -5px 0 blue,
                      -5px -5px 0 blue;
    }
    #redbumper {
        color: white;
        text-shadow: -5px 5px 0 red,
                      5px 5px 0 red,
                      5px -5px 0 red,
                      -5px -5px 0 red;
    }
    h2 {
        font-size: 13rem;
        color: #ffc145;
    }
    h3 {
        font-size: 13rem;
        color: #ffc145;
    }

            body {
            margin: 0;
            padding: 0;
            position: relative;
            border: 0.5rem solid; /* Adjust border width as needed */
            border-image: linear-gradient(to bottom right, #F6B14B, #FF4848) 30;
            height: calc(100vh);
			overflow: hidden; /* Hide scrollbars */
        }
        #thediv {
            display: grid;
            grid-template-columns: 4;
            grid-template-rows: 7;
            grid-gap: 2%;
            width: 95%;
            height: 95%;
            position: absolute;
            padding: 1%;
            margin: auto;
            top: 7%;
            left: 50%;
            transform: translate(-50%);
        }
        .btn {
            width: 80%;
        }
        .inner-div {
            padding: 2%;
            border-radius: 5px;
            color: #FFFFFF;
            font-family: "Poppins", sans-serif;
            font-weight: 700;
            font-style: normal;
            text-align: center;
            margin: auto;
            font-size: 3rem;
            width: 100%;
            height: fit-content;
            border-color: #FFC145;
            border-width: 6px;
            border-style: solid;
        }
        /* .border {
            position: relative;
            width: 475px;
            height: 475px;
            background: linear-gradient(to right, red, )
        } */
    h4 {
        color: #ffffff;
        margin: 0.5rem;
        font-family: "Poppins", sans-serif;
        font-weight: 700;
        font-style: normal;
        font-size: 3rem;
        border-radius: 5px;
    }
    #header {
        display: grid;
        grid-template-columns: 2;
        grid-template-rows: 1;
    }
    #title {
        background-color: #ffc145;
        font-family: "Poppins", sans-serif;
        font-weight: 700;
        font-style: normal;
        font-size: 5rem;
        background-image: linear-gradient(to bottom right, #f6b14b, #ff4848);
        background-clip: text;
        -webkit-text-fill-color: transparent;
        margin: auto;
    }
    #time {
        color: #ffc145;
        font-family: "Poppins", sans-serif;
        font-weight: 700;
        font-style: normal;
        font-size: 5rem;
        text-align: center;
        margin: auto;
    }
</style>
